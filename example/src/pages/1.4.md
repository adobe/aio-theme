<Hero slots="heading" />

# Adobe Analytics v1.4

Use the following steps to reduce the amount of time it takes your store to deploy an update to Production:

1. [Upgrade to the `{{site.data.var.ct}}` package]({{ site.baseurl }}/cloud/project/ece-tools-upgrade-project.html) or [update the `{{site.data.var.ct}}` version]({{ site.baseurl }}/cloud/project/ece-tools-update.html)
   Your {{site.data.var.ece}} project must have the latest `{{site.data.var.ct}}` package so that you have the tools available to configure an optimal deployment. If you have the latest `{{site.data.var.ct}}`, continue to the next step.

   {:.bs-callout-info}
   Even though it is a best practice to use the latest `{{site.data.var.ct}}` package, the zero-downtime deployment method works with `{{site.data.var.ct}}` [version 2002.0.13]({{ site.baseurl }}/cloud/release-notes/cloud-release-archive.html#v2002013) and later.

1. [Configure static content deployment]({{ site.baseurl }}/cloud/deploy/static-content-deployment.html)
   If static content deployment fails in the deploy phase, your site gets stuck in maintenance mode. When a failure occurs during the build phase, the process avoids downtime because it never begins the deploy phase. [Generating static content during the build phase with minified HTML]({{ site.baseurl }}/cloud/deploy/static-content-deployment.html#setting-the-scd-on-build), also known as the ideal state, is the optimal configuration for zero-downtime deployments and _prevents_ downtime if a failure occurs.

1. [Configure the post-deploy hook]({{ site.baseurl }}/cloud/project/magento-app-properties.html#hooks)
   You must configure the post-deploy hook to clean and warm the cache. By default, cache clean occurs during the deploy phase when the site is down. Moving the cache clean to the post-deploy phase means that your cache remains live until the deploy phase is complete, and then you can safely clean the cache.

   Customize the list of pages used to preload the cache with the [WARM_UP_PAGES environment variable]({{ site.baseurl }}/cloud/env/variables-post-deploy.html#warm_up_pages).

1. [Reduce theme files]({{ site.baseurl }}/cloud/env/variables-deploy.html#scd_matrix)
   You can reduce the amount of unnecessary theme files by configuring the SCD\_MATRIX environment variable.

1. [Speed up static content deployment]({{ site.baseurl }}/cloud/env/variables-deploy.html#scd_threads)
   You can speed up the deployment process by updating the  SCD\_THREADS environment variable to increase the number of threads for static content deployment.

| Name       | Service   | Key & options  | Available Versions | Notes
| ------------- | ---------- | ---------- | ------------------ |------------------
| [db] | MariaDB or MySQL<br/>     | `--db`, `--db-image` (MySQL)<br/>`--expose-db-port`<br/>`--db-increment`<br/>`--db-offset`<br/>`--with-entrypoint`<br/>`--with-mariadb-config`|10.0, 10.1, 10.2<br/>5.6, 5.7 | Use the increment and offset options to customize the [auto-increment settings][Using AUTO_INCREMENT] for replication.<br/><br/>Use the `--with-entrypoint` and `--with-mariadb-config` options to automatically configure database directories in the Docker environment<br/><br/>*Example build commands:*<br/>`ece-docker build:compose --db <mariadb-version>`<br/>`ece-docker build:compose --db <mysql-version> --db-image`
| [elasticsearch] | Elasticsearch | `--es`<br/>`--es-env-var`<br/>`--no-es` | 5.2, 6.5, 6.8, 7.5, 7.6, 7.7, 7.9 | Use the options to specify the Elasticsearch version,  customize Elasticsearch configuration options, or to build a Docker environment without Elasticsearch.
| [fpm][fpm-container] | PHP FPM | `--php`<br/>`--with-xdebug` | 7.2, 7.3, 7.4 |  Used for all incoming requests. Optionally, install a specific php version or add Xdebug to debug PHP code in the Docker environment.
| [fpm_xdebug][fpm_xdebug-container] | Xdebug | `--set-docker-host` | latest | Optional container for PHP debugging<br/>On Linux systems, `--set-docker-host` sets the `.host.docker.internal` value in the container `/etc/hosts` file.
| [mailhog][mailhog-container] | MailHog |  `--no-mailhog`<br/>`--mailhog-http-port`<br/>`--mailhog-smtp-port` | latest | Email service to replace Sendmail service, which can cause issues in Docker environment
| [node][node-container] | Node | `--node` | 6, 8, 10, 11 |  Node container to run gulp or other NPM based commands in the Docker environment. Use the `--node` option to install a specific node version.
| [rabbitmq][rabbitmq-container]| RabbitMQ | `--rmq` | 3.5, 3.7, 3.8 | Use the `--rmq` option to install a specific RabbitMQ version.
| [redis][redis-container] | Redis     | `--redis` | 3.2, 5.0, 6.0 |   Standard redis container
| [selenium][selenium-container]| Selenium | `--with-selenium`<br/>`--selenium-version`<br/>`--selenium-image`| Any | Enables Magento application testing using the Magento Functional Testing Framework (MFTF)
| [test][test-container]| PHP CLI | `--with-test`| Any | Optional container with a writable file system for running tests
| [tls][tls-container] | SSL Endpoint | `--tls-port`<br/>`--no-tls` | nginx 1.19-1.2.0, latest  |  Terminates SSL, can be configured to pass to varnish or nginx. Use the `--tls-port` option to change the default port (443).<br/>Use the `--no-tls` option to disable tls.
| [varnish][varnish-container] | Varnish | `--no-varnish` | 4, 6.2 | Varnish is provisioned by default. Use the `--no-varnish` option to skip Varnish service installation.
| [web][web-container] | NGINX | `--nginx`<br/>`--nginx-worker-processes`<br/>`--nginx-worker-connections` | 1.19-1.2.1, latest | Use the `--nginx` option to install a specific nginx version.<br/>Use the `--nginx-worker-processes` option to define the number of NGINX worker processes. The default is 1.<br/>Use the `--nginx-worker-connections` option to define the maximum number of connections that each worker process can handle simultaneously. The default is 1024 NGINX worker connections per process.

Use the following command to view all available options for the `ece-docker build:compose` command:
